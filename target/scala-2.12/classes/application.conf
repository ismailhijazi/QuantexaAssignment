quantexa {
  input {
    flights = "data/flightData.csv"
    passengers = "data/passengers.csv"
  }
  output {
    mostFrequentFlyers = "results/MostFrequentFlyers.csv"
    singleCsv = true
  }
  spark {
    master = "local[*]"
    appName = "Quantexa Flight Stats Functional"
    spark.executor.memory = "16g"  # Enhancement 8: Increased from 8g
    spark.executor.cores = 3
    spark.default.parallelism = 32  # Enhancement 4: Increased from 16
    spark.sql.shuffle.partitions = 200
    spark.serializer = "org.apache.spark.serializer.KryoSerializer"  # Enhancement 2: Enable Kryo serialization
    spark.sql.autoBroadcastJoinThreshold = "200MB"  # Enhancement 5: Enable broadcast joins for tables up to 200MB
  }
}
